import{an as d,s as n}from"./index-CErRD7Zr.js";const y=(e={})=>{var c,t;const g=["products",{shopId:e.shopId,category:e.category,searchQuery:e.searchQuery,priceMin:(c=e.priceRange)==null?void 0:c[0],priceMax:(t=e.priceRange)==null?void 0:t[1],sortBy:e.sortBy,limit:e.limit}],i=d({queryKey:g,queryFn:async()=>{let r=n.from("products").select("*").eq("in_stock",!0);switch(e.shopId&&(r=r.eq("shop_id",e.shopId)),e.category&&e.category!=="All Categories"&&(r=r.eq("category",e.category)),e.searchQuery&&(r=r.or(`name.ilike.%${e.searchQuery}%,description.ilike.%${e.searchQuery}%`)),e.priceRange&&(r=r.gte("price",e.priceRange[0]).lte("price",e.priceRange[1])),e.sortBy){case"price-low":r=r.order("price",{ascending:!0});break;case"price-high":r=r.order("price",{ascending:!1});break;default:r=r.order("is_featured",{ascending:!1})}e.limit&&(r=r.limit(e.limit));const{data:l,error:s}=await r;if(s)throw s;return(l||[]).map(a=>({id:a.id,name:a.name,description:a.description,price:Number(a.price),originalPrice:a.original_price?Number(a.original_price):void 0,category:a.category,imageUrl:a.image_url,inStock:a.in_stock,shopId:a.shop_id,sku:a.sku,weight:a.weight,nutritionInfo:a.nutrition_info,isFeatured:a.is_featured,createdAt:new Date(a.created_at),updatedAt:new Date(a.updated_at)}))},staleTime:1*60*1e3,gcTime:10*60*1e3,retry:1,refetchOnWindowFocus:!1,keepPreviousData:!0});return{products:i.data||[],loading:i.isLoading,error:i.error?"Failed to load products":null,refetch:i.refetch}};export{y as u};
