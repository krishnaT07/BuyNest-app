"use client";
import{c as C,r as m,a5 as S,u as y,a6 as k,j as e,L as T,i as x,f as p,n as h,a7 as P,B as b,h as A,s as O,a8 as E,k as N,l as w,m as F,o as _,p as H,g as L,V as D}from"./index-C7_V5JWq.js";import{T as U,a as I,b as j,c as g}from"./tabs-BeHpJeVH.js";import{H as f}from"./Header-LcFRmaEJ.js";import{F as v}from"./Footer-DtqQTw7U.js";import{u as $}from"./useProducts-Ccz9LixC.js";import"./index-Mkei7zYV.js";import"./settings-JGNURzKf.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=C("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),q=({product:s,shopName:l})=>{const[r,d]=m.useState(!1),{addToCart:n}=S(),{toast:c}=y(),{isInWishlist:o,toggleWishlist:u}=k(),a=async i=>{i.preventDefault(),i.stopPropagation(),d(!0);try{n({id:s.id,name:s.name,price:s.price,quantity:1,shopId:s.shopId,shopName:l||"Unknown Shop",imageUrl:s.imageUrl}),c({title:"Added to cart",description:`${s.name} has been added to your cart.`})}catch{c({title:"Error",description:"Failed to add item to cart.",variant:"destructive"})}finally{d(!1)}},t=s.originalPrice?Math.round((s.originalPrice-s.price)/s.originalPrice*100):0;return e.jsx(T,{to:`/products/${s.id}`,children:e.jsxs(x,{className:"h-full hover:shadow-lg transition-shadow cursor-pointer group",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"aspect-square bg-gray-100 overflow-hidden rounded-t-lg",children:e.jsx("img",{src:s.imageUrl||"/images/products/default-product.jpg",alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",loading:"lazy",decoding:"async",onError:i=>{i.currentTarget.src="/images/products/default-product.jpg"}})}),t>0&&e.jsxs(p,{variant:"destructive",className:"absolute top-2 left-2",children:[t,"% OFF"]}),!s.inStock&&e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center rounded-t-lg",children:e.jsx(p,{variant:"secondary",className:"text-white bg-gray-800",children:"Out of Stock"})})]}),e.jsx(h,{className:"p-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"font-semibold text-sm line-clamp-2 group-hover:text-primary transition-colors",children:s.name}),e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"font-bold text-lg text-primary",children:["$",s.price]}),s.originalPrice&&e.jsxs("span",{className:"text-sm text-muted-foreground line-through",children:["$",s.originalPrice]})]}),s.weight&&e.jsx("span",{className:"text-xs text-muted-foreground",children:s.weight})]}),e.jsx("button",{"aria-label":"Toggle wishlist",onClick:i=>{i.preventDefault(),i.stopPropagation(),u({id:s.id,name:s.name,imageUrl:s.imageUrl,price:s.price})},className:`p-1 rounded ${o(s.id)?"text-red-500":"text-muted-foreground hover:text-foreground"}`,children:e.jsx(M,{className:"h-4 w-4"})})]})]})}),e.jsx(P,{className:"p-4 pt-0",children:e.jsx(b,{onClick:a,disabled:!s.inStock||r,className:"w-full",size:"sm",children:r?"Adding...":e.jsx(e.Fragment,{children:s.inStock?e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"h-4 w-4 mr-2"}),"Add to Cart"]}):"Out of Stock"})})})]})})},B=s=>{const[l,r]=m.useState(null),[d,n]=m.useState(!0),[c,o]=m.useState(null);return m.useEffect(()=>{(async()=>{if(!s){n(!1);return}try{n(!0),o(null);const{data:a,error:t}=await O.from("shops").select("*").eq("id",s).single();if(t)throw t;const i={id:a.id,name:a.name,description:a.description,address:a.address,phone:a.phone,email:a.email,rating:a.rating,reviewCount:a.review_count,openingHours:a.opening_hours,categories:a.categories||[],isOpen:a.is_open,deliveryTime:a.delivery_time,minimumOrder:a.minimum_order,ownerId:a.owner_id,imageUrl:a.image_url,createdAt:new Date(a.created_at),updatedAt:new Date(a.updated_at)};r(i)}catch(a){console.error("Error fetching shop:",a),o("Failed to load shop details")}finally{n(!1)}})()},[s]),{shop:l,loading:d,error:c,refetch:()=>window.location.reload()}},Q=()=>{const{shopId:s}=E(),{toast:l}=y(),{shop:r,loading:d,error:n}=B(s),{products:c,loading:o,error:u}=$({shopId:s}),a=d||o,t=n||u;return m.useEffect(()=>{t&&l({title:"Error",description:t,variant:"destructive"})},[t,l]),a?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(f,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"}),e.jsx("div",{className:"h-64 bg-muted rounded"})]})}),e.jsx(v,{})]}):!r&&!a?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(f,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shop not found"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"The shop you're looking for doesn't exist."})]}),e.jsx(v,{})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(f,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(x,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(w,{className:"text-2xl",children:r.name}),e.jsx(F,{className:"text-lg mt-2",children:r.description})]}),e.jsx(p,{variant:r.isOpen?"default":"destructive",children:r.isOpen?"Open":"Closed"})]})}),e.jsxs(h,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(_,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:r.rating}),e.jsxs("span",{children:["(",r.reviewCount," reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(H,{className:"h-4 w-4"}),e.jsx("span",{children:r.deliveryTime})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(L,{className:"h-4 w-4"}),e.jsx("span",{children:r.address})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{children:r.phone})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r.categories.map(i=>e.jsx(p,{variant:"secondary",children:i},i))})]})]}),e.jsxs(U,{defaultValue:"products",className:"mt-8",children:[e.jsxs(I,{children:[e.jsx(j,{value:"products",children:"Products"}),e.jsx(j,{value:"reviews",children:"Reviews"}),e.jsx(j,{value:"info",children:"Store Info"})]}),e.jsx(g,{value:"products",className:"mt-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:c.map(i=>e.jsx(q,{product:i,shopName:r.name},i.id))})}),e.jsx(g,{value:"reviews",className:"mt-6",children:e.jsx(x,{children:e.jsx(h,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"Reviews will be displayed here."})})})}),e.jsx(g,{value:"info",className:"mt-6",children:e.jsx(x,{children:e.jsxs(h,{className:"pt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Opening Hours"}),e.jsx("p",{className:"text-muted-foreground",children:r.openingHours})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Minimum Order"}),e.jsxs("p",{className:"text-muted-foreground",children:["â‚¹",r.minimumOrder]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Contact"}),e.jsx("p",{className:"text-muted-foreground",children:r.email})]})]})})})]})]}),e.jsx("div",{children:e.jsxs(x,{children:[e.jsx(N,{children:e.jsx(w,{children:"Order Summary"})}),e.jsxs(h,{children:[e.jsx("p",{className:"text-muted-foreground mb-4",children:"Add items to your cart to see the order summary."}),e.jsx(b,{className:"w-full",disabled:!0,children:"Add items to cart"})]})]})})]})}),e.jsx(v,{})]})};export{Q as default};
