"use client";
import{r as h,u as N,j as t,b as j,g as L,B as y}from"./index-C7_V5JWq.js";import{T as b}from"./textarea-B3eKeinw.js";import{N as E}from"./navigation-DQJChiP-.js";const C=({label:a,value:p,onChange:r,placeholder:x="Enter address or use current location",disabled:n=!1,required:c=!1,rows:f=2,helperText:d})=>{const[l,i]=h.useState(!1),{toast:o}=N(),g=()=>{if(!navigator.geolocation){o({title:"Geolocation not supported",description:"Your browser doesn't support location services",variant:"destructive"});return}i(!0),navigator.geolocation.getCurrentPosition(async e=>{try{const{latitude:s,longitude:u}=e.coords,m=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${s}&lon=${u}`);if(!m.ok)throw new Error("Failed to fetch address");const v=(await m.json()).display_name||`${s}, ${u}`;r(v),o({title:"Location detected",description:"Your current location has been added"})}catch(s){console.error("Reverse geocoding error:",s),o({title:"Could not get address",description:"Using coordinates instead",variant:"destructive"}),r(`${e.coords.latitude}, ${e.coords.longitude}`)}finally{i(!1)}},e=>{console.error("Geolocation error:",e),i(!1);let s="Could not get your location";e.code===e.PERMISSION_DENIED?s="Location access denied. Please enable location permissions.":e.code===e.POSITION_UNAVAILABLE?s="Location information unavailable":e.code===e.TIMEOUT&&(s="Location request timed out"),o({title:"Location Error",description:s,variant:"destructive"})},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})};return t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs(j,{htmlFor:a,className:"flex items-center gap-2",children:[t.jsx(L,{className:"h-4 w-4 text-primary"}),a," ",c&&t.jsx("span",{className:"text-destructive",children:"*"})]}),t.jsxs(y,{type:"button",variant:"ghost",size:"sm",onClick:g,disabled:l||n,className:"h-8 text-xs",children:[l?t.jsx("div",{className:"w-3 h-3 border-2 border-primary/30 border-t-primary rounded-full animate-spin mr-2"}):t.jsx(E,{className:"h-3 w-3 mr-2"}),"Use Current Location"]})]}),t.jsx(b,{id:a,value:p,onChange:e=>r(e.target.value),placeholder:x,disabled:n,required:c,rows:f,className:"resize-none"}),d&&t.jsx("p",{className:"text-xs text-muted-foreground",children:d})]})};export{C as L};
