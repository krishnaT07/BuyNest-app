import{r as c,s as D,ac as P,u as H,g as M,ad as k,j as e,k as d,n as j,o as f,p as F,q as S,l as n,t as L,Y as T,v as O,W as E,m as N,B as _,a7 as q}from"./index-CErRD7Zr.js";import{T as A,a as B,b as g,c as v}from"./tabs-B41GjFOe.js";import{H as w}from"./Header-DA9uUddq.js";import{F as y}from"./Footer-oT7lwhk_.js";import{P as I}from"./ProductCard-CeFAnCS8.js";import{u as R}from"./useProducts-CDKyLWUj.js";import"./index-Dvkyeb8o.js";const V=t=>{const[o,i]=c.useState(null),[h,l]=c.useState(!0),[a,m]=c.useState(null);return c.useEffect(()=>{(async()=>{if(!t){l(!1);return}try{l(!0),m(null);const{data:s,error:x}=await D.from("shops").select("*").eq("id",t).single();if(x)throw x;const p={id:s.id,name:s.name,description:s.description,address:s.address,phone:s.phone,email:s.email,rating:s.rating,reviewCount:s.review_count,openingHours:s.opening_hours,categories:s.categories||[],isOpen:s.is_open,deliveryTime:s.delivery_time,minimumOrder:s.minimum_order,ownerId:s.owner_id,imageUrl:s.image_url,createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)};i(p)}catch(s){console.error("Error fetching shop:",s),m("Failed to load shop details")}finally{l(!1)}})()},[t]),{shop:o,loading:h,error:a,refetch:()=>window.location.reload()}},K=()=>{const{shopId:t}=P(),{toast:o}=H(),{items:i,totalPrice:h}=M(),{deliveryMode:l}=k(),{shop:a,loading:m,error:b}=V(t),{products:s,loading:x,error:p}=R({shopId:t}),C=m||x,u=b||p;return c.useEffect(()=>{u&&o({title:"Error",description:u,variant:"destructive"})},[u,o]),C?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(w,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"animate-pulse space-y-4",children:[e.jsx("div",{className:"h-8 bg-muted rounded w-1/3"}),e.jsx("div",{className:"h-4 bg-muted rounded w-1/2"}),e.jsx("div",{className:"h-64 bg-muted rounded"})]})}),e.jsx(y,{})]}):!a&&!C?e.jsxs("div",{className:"min-h-screen",children:[e.jsx(w,{}),e.jsxs("div",{className:"container mx-auto px-4 py-8 text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Shop not found"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"The shop you're looking for doesn't exist."})]}),e.jsx(y,{})]}):e.jsxs("div",{className:"min-h-screen",children:[e.jsx(w,{}),e.jsx("div",{className:"container mx-auto px-4 py-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsxs(d,{children:[e.jsx(j,{children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx(f,{className:"text-2xl",children:a.name}),e.jsx(F,{className:"text-lg mt-2",children:a.description})]}),e.jsx(S,{variant:a.isOpen?"default":"destructive",children:a.isOpen?"Open":"Closed"})]})}),e.jsxs(n,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(L,{className:"h-4 w-4 fill-yellow-400 text-yellow-400"}),e.jsx("span",{children:a.rating}),e.jsxs("span",{children:["(",a.reviewCount," reviews)"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{children:a.deliveryTime})]})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(O,{className:"h-4 w-4"}),e.jsx("span",{children:a.address})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(E,{className:"h-4 w-4"}),e.jsx("span",{children:a.phone})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:a.categories.map(r=>e.jsx(S,{variant:"secondary",children:r},r))})]})]}),e.jsxs(A,{defaultValue:"products",className:"mt-8",children:[e.jsxs(B,{children:[e.jsx(g,{value:"products",children:"Products"}),e.jsx(g,{value:"reviews",children:"Reviews"}),e.jsx(g,{value:"info",children:"Store Info"})]}),e.jsx(v,{value:"products",className:"mt-6",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6",children:s&&s.length>0?s.map(r=>e.jsx(I,{product:r,shopName:a.name},r.id)):e.jsx("div",{className:"col-span-full text-center py-8",children:e.jsx("p",{className:"text-muted-foreground",children:"No products available in this shop."})})})}),e.jsx(v,{value:"reviews",className:"mt-6",children:e.jsx(d,{children:e.jsx(n,{className:"pt-6",children:e.jsx("p",{className:"text-muted-foreground",children:"Reviews will be displayed here."})})})}),e.jsx(v,{value:"info",className:"mt-6",children:e.jsx(d,{children:e.jsxs(n,{className:"pt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Opening Hours"}),e.jsx("p",{className:"text-muted-foreground",children:a.openingHours})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Minimum Order"}),e.jsxs("p",{className:"text-muted-foreground",children:["₹",a.minimumOrder]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Contact"}),e.jsx("p",{className:"text-muted-foreground",children:a.email})]})]})})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(d,{children:[e.jsx(j,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(N,{className:"h-5 w-5"}),"Order Summary"]})}),e.jsx(n,{children:i.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"space-y-2",children:i.map(r=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:r.name}),e.jsxs("p",{className:"text-muted-foreground",children:["Qty: ",r.quantity]})]}),e.jsxs("p",{className:"font-medium",children:["₹",(r.price*r.quantity).toFixed(2)]})]},r.id))}),e.jsxs("div",{className:"border-t pt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-1",children:[e.jsx("span",{children:"Delivery Mode:"}),e.jsx("span",{className:"capitalize",children:l})]}),e.jsxs("div",{className:"flex items-center justify-between font-semibold",children:[e.jsx("span",{children:"Total:"}),e.jsxs("span",{children:["₹",h.toFixed(2)]})]})]}),e.jsxs(_,{className:"w-full",onClick:()=>window.location.href="/cart",children:[e.jsx(N,{className:"h-4 w-4 mr-2"}),"View Cart (",i.length,")"]})]}):e.jsxs("div",{className:"text-center py-4",children:[e.jsx(N,{className:"h-12 w-12 text-muted-foreground mx-auto mb-2"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Your cart is empty. Add some products to get started!"}),e.jsx(_,{className:"w-full",disabled:!0,children:"Add items to cart"})]})})]}),e.jsxs(d,{children:[e.jsx(j,{children:e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5"}),"Delivery Info"]})}),e.jsxs(n,{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(T,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.deliveryTime})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(O,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(E,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.phone})]}),e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Minimum order: ",e.jsxs("span",{className:"font-medium",children:["₹",a.minimumOrder]})]})})]})]})]})]})}),e.jsx(y,{})]})};export{K as default};
