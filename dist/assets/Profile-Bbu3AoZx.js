"use client";
import{c as k,U as L,u as B,av as M,r as m,j as e,i as j,k as v,l as f,f as U,n as g,ay as D,au as T,B as r,aA as V,b as i,I as N,M as z,V as R,g as q,s as H,aB as K}from"./index-C7_V5JWq.js";import{T as Y}from"./textarea-B3eKeinw.js";import{S as J}from"./separator-DHEMzE8V.js";import{A as W,c as X,b as Z,S as $,a as G}from"./avatar-MlZcFUsK.js";import{L as O}from"./LocationInput-C6dYuTVz.js";import"./navigation-DQJChiP-.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=k("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=k("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]),ie=()=>{var b;const{user:s,updateUser:A}=L(),{toast:t}=B(),{addresses:y,addAddress:C,removeAddress:P}=M(),[l,h]=m.useState(!1),[n,c]=m.useState(!1),[d,x]=m.useState({name:"",phone:"",address:""});m.useEffect(()=>{s&&x({name:s.name||"",phone:s.phone||"",address:s.address||""})},[s]);const u=(a,p)=>{x(o=>({...o,[a]:p}))},E=()=>d.name.trim()?d.phone&&!K(d.phone)?(t({title:"Validation Error",description:"Please enter a valid phone number.",variant:"destructive"}),!1):!0:(t({title:"Validation Error",description:"Name is required.",variant:"destructive"}),!1),S=async()=>{if(E()){c(!0);try{await A(d),h(!1),t({title:"Profile Updated",description:"Your profile has been updated successfully."})}catch(a){console.error("Profile update error:",a),t({title:"Update Failed",description:"Failed to update profile. Please try again.",variant:"destructive"})}finally{c(!1)}}},I=()=>{s&&x({name:s.name||"",phone:s.phone||"",address:s.address||""}),h(!1)},F=async()=>{if(s!=null&&s.email){c(!0);try{const{error:a}=await H.auth.resetPasswordForEmail(s.email,{redirectTo:`${window.location.origin}/auth/reset-password`});if(a)throw a;t({title:"Password Reset Email Sent",description:"Please check your email for the password reset link."})}catch(a){console.error("Password reset error:",a),t({title:"Failed to Send Reset Email",description:a.message||"Please try again later.",variant:"destructive"})}finally{c(!1)}}};return s?e.jsx("div",{className:"min-h-screen bg-background",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"My Profile"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage your account information"})]}),e.jsxs("div",{className:"grid lg:grid-cols-3 gap-8",children:[e.jsxs(j,{className:"lg:col-span-1",children:[e.jsxs(v,{className:"text-center",children:[e.jsxs(W,{className:"w-24 h-24 mx-auto mb-4",children:[e.jsx(X,{src:s.avatar,alt:s.name}),e.jsx(Z,{className:"text-xl",children:((b=s.name)==null?void 0:b.charAt(0).toUpperCase())||"U"})]}),e.jsx(f,{children:s.name||"User"}),e.jsx("p",{className:"text-muted-foreground",children:s.email}),e.jsx("div",{className:"flex justify-center mt-4",children:e.jsx(U,{variant:"secondary",className:"capitalize",children:s.role})})]}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(Q,{className:"w-4 h-4"}),e.jsxs("span",{children:["Joined ",D(s.createdAt)]})]}),s.isVerified&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full"}),e.jsx("span",{children:"Verified Account"})]})]})]}),e.jsxs(j,{className:"lg:col-span-2",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(f,{className:"flex items-center gap-2",children:[e.jsx(T,{className:"w-5 h-5"}),"Personal Information"]}),l?e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(r,{variant:"outline",size:"sm",onClick:I,disabled:n,children:[e.jsx(V,{className:"w-4 h-4 mr-2"}),"Cancel"]}),e.jsxs(r,{size:"sm",onClick:S,disabled:n,children:[n?e.jsx("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}):e.jsx(G,{className:"w-4 h-4 mr-2"}),"Save"]})]}):e.jsxs(r,{variant:"outline",size:"sm",onClick:()=>h(!0),children:[e.jsx($,{className:"w-4 h-4 mr-2"}),"Edit"]})]})}),e.jsxs(g,{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx(i,{htmlFor:"name",children:"Full Name"}),l?e.jsx(N,{id:"name",value:d.name,onChange:a=>u("name",a.target.value),className:"mt-1"}):e.jsx("div",{className:"mt-1 p-3 bg-muted/50 rounded-md",children:s.name||"Not provided"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Email Address"}),e.jsxs("div",{className:"mt-1 p-3 bg-muted/30 rounded-md flex items-center gap-2",children:[e.jsx(z,{className:"w-4 h-4 text-muted-foreground"}),s.email]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Email cannot be changed. Contact support if needed."})]}),e.jsxs("div",{children:[e.jsx(i,{htmlFor:"phone",children:"Phone Number"}),l?e.jsx(N,{id:"phone",type:"tel",value:d.phone,onChange:a=>u("phone",a.target.value),className:"mt-1",placeholder:"Enter your phone number"}):e.jsxs("div",{className:"mt-1 p-3 bg-muted/50 rounded-md flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4 text-muted-foreground"}),s.phone||"Not provided"]})]}),e.jsx("div",{children:l?e.jsx(O,{label:"Address",value:d.address,onChange:a=>u("address",a),placeholder:"Enter your address",rows:3,helperText:"Your primary residential address"}):e.jsxs(e.Fragment,{children:[e.jsx(i,{htmlFor:"address",children:"Address"}),e.jsxs("div",{className:"mt-1 p-3 bg-muted/50 rounded-md flex items-start gap-2",children:[e.jsx(q,{className:"w-4 h-4 text-muted-foreground mt-0.5"}),e.jsx("span",{children:s.address||"Not provided"})]})]})}),e.jsx(J,{}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold",children:"Account Actions"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs(r,{variant:"outline",className:"justify-start",onClick:F,disabled:n,children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Change Password"]}),e.jsx(r,{variant:"outline",className:"justify-start",disabled:!0,children:"Download Data"}),e.jsx(r,{variant:"outline",className:"justify-start",disabled:!0,children:"Privacy Settings"}),e.jsx(r,{variant:"destructive",className:"justify-start",disabled:!0,children:"Delete Account"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:'Click "Change Password" to receive a password reset link via email.'})]})]})]}),e.jsxs(j,{className:"lg:col-span-3",children:[e.jsx(v,{children:e.jsx(f,{children:"Address Book"})}),e.jsxs(g,{className:"space-y-4",children:[e.jsxs("div",{className:"grid md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx(i,{children:"New Address"}),e.jsx(Y,{className:"mt-1",placeholder:"Line 1, Line 2, City, State, ZIP",id:"newAddress"})]}),e.jsxs("div",{children:[e.jsx(i,{children:"Label"}),e.jsx(N,{className:"mt-1",placeholder:"Home / Work",id:"newLabel"}),e.jsx(r,{className:"mt-2",onClick:()=>{var o,w;const a=((o=document.getElementById("newAddress"))==null?void 0:o.value)||"",p=((w=document.getElementById("newLabel"))==null?void 0:w.value)||"Address";if(!a.trim()){t({title:"Enter address",variant:"destructive"});return}C({label:p,line1:a}),document.getElementById("newAddress").value="",document.getElementById("newLabel").value="",t({title:"Address saved"})},children:"Save Address"})]})]}),y.length===0?e.jsx("p",{className:"text-sm text-muted-foreground",children:"No saved addresses yet."}):e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:y.map(a=>e.jsxs("div",{className:"p-3 rounded border flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.label}),e.jsx("p",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:a.line1})]}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>P(a.id),children:"Remove"})]},a.id))})]})]})]})]})}):e.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:e.jsx("div",{className:"text-center",children:e.jsx("p",{className:"text-muted-foreground",children:"Please log in to view your profile."})})})};export{ie as default};
